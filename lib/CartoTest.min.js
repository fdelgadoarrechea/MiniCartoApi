(function(a,b){'object'==typeof exports&&'object'==typeof module?module.exports=b(require('L')):'function'==typeof define&&define.amd?define('CartoTest',['L'],b):'object'==typeof exports?exports.CartoTest=b(require('L')):a.CartoTest=b(a.L)})(this,function(a){return function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,b),e.l=!0,e.exports}var c={};return b.m=a,b.c=c,b.d=function(a,c,d){b.o(a,c)||Object.defineProperty(a,c,{configurable:!1,enumerable:!0,get:d})},b.n=function(a){var c=a&&a.__esModule?function(){return a['default']}:function(){return a};return b.d(c,'a',c),c},b.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},b.p='',b(b.s=0)}([function(a,b,c){'use strict';function d(a){return a&&a.__esModule?a:{default:a}}var e=c(1),f=d(e),g=c(2),h=d(g),i=c(3),j=d(i),k=c(4),l=d(k);a.exports=class{constructor(){this.config=new h.default(f.default),this.renderer=new l.default(this.config.getCenter(),this.config.getZoom()),this.renderer.renderMap('mapid'),this.cartoLayer='',this.initCartoLayer()}async initCartoLayer(){this.cartoLayer||(this.cartoLayer=new j.default(this.config.getUser()),this.cartoLayer.setMapConfig(this.config.getMapConfig())),await this.cartoLayer.generateTemplateURL(this.config.getURL()),this.showLayers()}showCartoLayer(){this.renderer.renderLayer(this.cartoLayer.getTemplateURL())}showLayers(){this.renderer.renderLayers(this.config.getLayers()),this.showCartoLayer()}setSQL(a){this.cartoLayer.setSQL(a),this.initCartoLayer()}hideLayer(a){this.renderer.hideLayer(a)}showLayer(a){this.renderer.showLayer(a)}}},function(a){a.exports={center:'[52.5897007687178, 52.734375]',zoom:4,maps_api_config:{user_name:'documentation',maps_api_template:'http://{user}.cartodb.com:80'},layers:[{type:'tiled',options:{urlTemplate:'http://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png',minZoom:'0',maxZoom:'18',attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}},{type:'CartoDB',options:{sql:'select * from european_countries_e',cartocss:'/** choropleth visualization */\n\n#european_countries_e{\n  polygon-fill: #FFFFB2;\n  polygon-opacity: 0.8;\n  line-color: #FFF;\n  line-width: 1;\n  line-opacity: 0.5;\n}\n#european_countries_e [ area <= 1638094] {\n   polygon-fill: #B10026;\n}\n#european_countries_e [ area <= 55010] {\n   polygon-fill: #E31A1C;\n}\n#european_countries_e [ area <= 34895] {\n   polygon-fill: #FC4E2A;\n}\n#european_countries_e [ area <= 12890] {\n   polygon-fill: #FD8D3C;\n}\n#european_countries_e [ area <= 10025] {\n   polygon-fill: #FEB24C;\n}\n#european_countries_e [ area <= 9150] {\n   polygon-fill: #FED976;\n}\n#european_countries_e [ area <= 5592] {\n   polygon-fill: #FFFFB2;\n}',cartocss_version:'2.1.1'}},{options:{urlTemplate:'http://{s}.basemaps.cartocdn.com/light_only_labels/{z}/{x}/{y}.png',minZoom:'0',maxZoom:'18',attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'},type:'tiled'}]}},function(a,b){'use strict';Object.defineProperty(b,'__esModule',{value:!0});b.default=class{constructor(a){this._config=a,this._url='',this._mapconfig='',this._user='',this._layers=[],this._center=a.center,this._zoom=a.zoom}getCenter(){let a=this._center;return this._center=a.slice(1,-1).split(','),this._center}getZoom(){return this._zoom}getUser(){return this._user=this._config.maps_api_config.user_name,this._user}getURL(){return this._url=`https://${this.getUser()}.carto.com/api/v1/map`,this._url}getMapConfig(){let a=this._config.layers,b=[],c='';return a.forEach(function(a){'CartoDB'===a.type?c={version:'1.3.1',layers:[{type:'cartodb',options:a.options}]}:b.push(a.options.urlTemplate)}),this._mapconfig=c,this._layers=b,this._mapconfig}getLayers(){return this._layers}},a.exports=b['default']},function(a,b){'use strict';Object.defineProperty(b,'__esModule',{value:!0});b.default=class{constructor(a){this._cdnURL='http://ashbu.cartocdn.com/',this._user=a,this._templateURL='',this._layergroupid='',this._mapconfig=''}setLayerGroupID(a){return this._layergroupid=a.layergroupid,this.getTemplateURL()}getTemplateURL(){return this._templateURL=`${this._cdnURL}${this._user}/api/v1/map/${this._layergroupid}/0/{z}/{x}/{y}.png`,this._templateURL}validateResponse(a){if(!a.ok)throw Error(a.statusText);return a}getMapConfig(){return this._mapconfig}setMapConfig(a){this._mapconfig=a}setSQL(a){this._mapconfig.layers[0].options.sql=a}async generateTemplateURL(a){let b=await fetch(a,{mode:'cors',method:'POST',body:JSON.stringify(this._mapconfig),headers:{Accept:'application/json',"Content-Type":'application/json'}}).then(this.validateResponse).then((a)=>a.json()).then((a)=>this.setLayerGroupID(a)).catch(this.logError);return b}logError(a){throw Error('Looks like there was a problem: \n',a)}},a.exports=b['default']},function(a,b,c){'use strict';Object.defineProperty(b,'__esModule',{value:!0});let d=c(5);b.default=class{constructor(a,b){this._center=a,this._zoom=b,this._templateURL='',this._currentMap='',this._layers=[],this._layer=''}renderMap(a){this._currentMap=d.map(a).setView(this._center,this._zoom)}hideLayer(a){let b=this._layers[a];b._container.style.opacity=0}showLayer(a){let b=this._layers[a];b._container.style.opacity=1}renderLayer(a){let b=this._currentMap;this._layer=d.tileLayer(a,{maxZoom:18}).addTo(b),this._layers.push(this._layer)}renderLayers(a){let b=this._currentMap,c=[];a.forEach(function(a){let e=d.tileLayer(a,{maxZoom:18}).addTo(b);c.push(e)}),this._layers=c}destroyLayer(){let a=this._currentMap;a.removeLayer(this._layer)}},a.exports=b['default']},function(b){b.exports=a}])});
//# sourceMappingURL=CartoTest.min.js.map